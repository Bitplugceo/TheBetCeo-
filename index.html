<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basketball Prediction Engine</title>

<style>
body {
  background: #111;
  color: #d4af37;
  font-family: Segoe UI, sans-serif;
  margin: 0;
}

h1 {
  text-align: center;
  margin-bottom: 12px;
  font-size: 18px;
}

.section {
  border: 1px solid #d4af37;
  background: #1a1a1a;
  padding: 8px 12px;
  margin: 10px auto;
  width: 92%;
  box-sizing: border-box;
}

.section h2 { font-size: 15px; margin-bottom: 6px; }

label { display: block; font-size: 12px; margin-bottom: 3px; }

input {
  width: 100%;
  max-width: 240px;
  padding: 4px 6px;
  font-size: 12px;
  background: #222;
  color: #d4af37;
  border: 1px solid #d4af37;
  margin-bottom: 6px;
}

input[type="checkbox"] { width: auto; margin-right: 6px; }

.buttons { text-align: center; margin-top: 10px; }

.btn {
  padding: 5px 14px;
  margin: 5px;
  font-size: 12px;
  font-weight: bold;
  background: #d4af37;
  color: #111;
  border: none;
  cursor: pointer;
}

.table-wrap { overflow-x: auto; margin-top: 10px; }

#results {
  width: 92%;
  margin: auto;
  border-collapse: collapse;
  font-size: 12px;
  display: none;
}

#results th, #results td {
  border: 1px solid #d4af37;
  padding: 5px;
  text-align: center;
}

.pred-over { background:#1e7d3a; color:#fff; font-weight:bold; }
.pred-under { background:#8b1e1e; color:#fff; font-weight:bold; }
.pred-noplay { background:#444; color:#bbb; font-weight:bold; }

.lock {
  font-size: 8px;
  display: inline-block;
  vertical-align: middle;
  transform: translateY(-1px);
  margin-left: 4px;
}
</style>
</head>

<body>

<h1>üèÄ Basketball Prediction Engine</h1>

<div class="section">
  <h2>Market Lines</h2>
  <label>FT Total Market</label><input id="ftMarket">
  <label>1H Total Market</label><input id="h1Market">
  <label>Team A Total Market</label><input id="teamAMarket">
  <label>Team B Total Market</label><input id="teamBMarket">
</div>

<div class="section">
  <h2>Team Scoring Averages</h2>
  <label>Team A FT Average</label><input id="teamAAvg">
  <label>Team B FT Average</label><input id="teamBAvg">
</div>

<div class="section">
  <h2>Head to Head (Optional)</h2>
  <label><input type="checkbox" id="useH2HFT"> Use H2H (FT)</label>
  <input id="h2hA" placeholder="Team A H2H FT Avg">
  <input id="h2hB" placeholder="Team B H2H FT Avg">
  <label><input type="checkbox" id="useH2H1H"> Use H2H (1H)</label>
  <input id="h2h1H" placeholder="1H H2H Avg Total">
</div>

<div class="section">
  <h2>Team Metrics</h2>
  <label>Team A Points Allowed</label><input id="papgA">
  <label>Team B Points Allowed</label><input id="papgB">
</div>

<div class="buttons">
  <button class="btn" onclick="runEngine()">Run</button>
  <button class="btn" onclick="clearAll()">Clear</button>
</div>

<div class="table-wrap">
<table id="results">
<tr>
  <th>Pick</th>
  <th>Engine Mid</th>
  <th>Edge</th>
  <th>Prediction</th>
  <th>Confidence %</th>
</tr>
</table>
</div>

<script>
function num(id){let v=parseFloat(document.getElementById(id).value);return isNaN(v)?NaN:v;}
function mid(r){if(!r||!r.includes("-"))return NaN;let[a,b]=r.split("-").map(x=>parseFloat(x));return(isNaN(a)||isNaN(b))?NaN:(a+b)/2;}
function clamp(v,min,max){return Math.max(min,Math.min(max,v));}
function confidence(e){if(isNaN(e))return 0;return Math.min(95,Math.round(70+(Math.abs(e)-3)*5));}

function runEngine(){
const table=document.getElementById("results");
table.style.display="table";
table.innerHTML=`<tr><th>Pick</th><th>Engine Mid</th><th>Edge</th><th>Prediction</th><th>Confidence %</th></tr>`;

let ftStr=ftMarket.value,h1Str=h1Market.value,aStr=teamAMarket.value,bStr=teamBMarket.value;
let ftM=mid(ftStr),h1M=mid(h1Str),aM=mid(aStr),bM=mid(bStr);

function rng(s){if(!s.includes("-"))return[NaN,NaN];let[l,h]=s.split("-").map(x=>parseFloat(x));return[l,h];}
let[ftL,ftH]=rng(ftStr),[h1L,h1H]=rng(h1Str),[aL,aH]=rng(aStr),[bL,bH]=rng(bStr);

let aAvg=num("teamAAvg"),bAvg=num("teamBAvg"),h2hA=num("h2hA"),h2hB=num("h2hB"),h2h1H=num("h2h1H");
let papgA=num("papgA"),papgB=num("papgB");
let useH2HFT=useH2HFT.checked,useH2H1H=useH2H1H.checked;

let aOff=useH2HFT?(0.7*aAvg+0.3*h2hA):aAvg;
let bOff=useH2HFT?(0.7*bAvg+0.3*h2hB):bAvg;
let aEng=(aOff+papgB)/2;
let bEng=(bOff+papgA)/2;

let offBase=aAvg+bAvg,h2hBase=h2hA+h2hB;
let ftOff=useH2HFT?(0.7*offBase+0.3*h2hBase):offBase;
let ftEng=(ftOff+papgA+papgB)/2;

let h1Eng=ftEng*0.48;
if(useH2H1H)h1Eng=(0.7*h1Eng+0.3*h2h1H);

function pick(name,eng,mkt,low,high){
let edge=eng-mkt,conf=confidence(edge),pred="NO PLAY";
if(!isNaN(edge)){
 if(edge>0)pred="OVER "+clamp(mkt-3,low,high).toFixed(1);
 else if(edge<0)pred="UNDER "+clamp(mkt+3,low,high).toFixed(1);
}
if(conf<70)pred="NO PLAY";
return{name,eng:isNaN(eng)?"NaN":eng.toFixed(2),edge:isNaN(edge)?"NaN":edge.toFixed(2),pred,conf,raw:edge};
}

let picks=[
pick("FT Total",ftEng,ftM,ftL,ftH),
pick("1H Total",h1Eng,h1M,h1L,h1H),
pick("Team A Total",aEng,aM,aL,aH),
pick("Team B Total",bEng,bM,bL,bH)
];

let lock=-1,max=0;
picks.forEach((p,i)=>{if(!isNaN(p.raw)&&Math.abs(p.raw)>max&&p.conf>=70){max=Math.abs(p.raw);lock=i;}});
picks.forEach((p,i)=>{
let r=results.insertRow();
let txt=p.pred;
if(i===lock&&p.pred!=="NO PLAY")txt+=` <span class="lock">üîí</span>`;
r.innerHTML=`<td>${p.name}</td><td>${p.eng}</td><td>${p.edge}</td>
<td class="${p.pred.startsWith("OVER")?"pred-over":p.pred.startsWith("UNDER")?"pred-under":"pred-noplay"}">${txt}</td>
<td>${p.conf}%</td>`;
});
}

function clearAll(){document.querySelectorAll("input").forEach(i=>i.type==="checkbox"?i.checked=false:i.value="");results.style.display="none";}
</script>

</body>
</html>